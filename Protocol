## Part 0: Create Project Folders and Clone Git Repository
cd $WORK
mkdir course_project
cd course_project
git clone https://github.com/sivanr92/Class_project.git 

# for each part, create a folder and named with “part1”,  “part2”, “part3”....
mkdir part1
mkdir part2

##Part 1: Data preparation
## Copy the link and use the wget to download it on swan
## Use GH31.txt to get a list of genbank ids of GH31 family
## Remove the redundant IDs
## Get unique ids in GH31

cd part1
wget http://www.cazy.org/IMG/cazy_data/GH31.txt   
cut -f 4 GH31.txt | grep -w ncbi > list_ids.txt  
cat list_ids.txt | sort |uniq > uniq_list_ids.txt 
wc -l uniq_list_ids.txt  # unique ids in GH31

## install the EDirect software, more information https://www.ncbi.nlm.nih.gov/books/NBK179288/
sh -c "$(curl -fsSL https://ftp.ncbi.nlm.nih.gov/entrez/entrezdirect/install-edirect.sh)" 

export PATH=${HOME}/edirect:${PATH}

# Answer "y" and press the Return key

export NCBI_API_KEY= your_API_KEY

## copy batch_download_protein_seqeunces.sh and run it (running time is about 30 min

cp ../Class_project/batch_download_protein_seqeunces.sh .
nano batch_download_protein_seqeunces.sh
# Revise to change email address in batch_download_protein_seqeunces.sh

bash batch_download_protein_seqeunces.sh


##Part 2: Domain annotation

## download annotation tools
##Go to the website: https://bcb.unl.edu/dbCAN2/download/Databases/dbCAN-old@UGA/ download “dbCAN-fam-HMMs.txt” and “hmmscan-parser.sh”
wget https://bcb.unl.edu/dbCAN2/download/Databases/dbCAN-old@UGA/dbCAN-fam-HMMs.txt
wget https://bcb.unl.edu/dbCAN2/download/Databases/dbCAN-old@UGA/hmmscan-parser.sh

##Use module load to activate hmmer on swan.

ml hmmer/3.3
hmmbuild -h  #To check if it works or not.

hmmpress dbCAN-fam-HMMs.txt

cp ../Class_project/hmmscan_run.slurm .
nano hmmscan_run.slurm


##Run the following commands to make the result readable 
##xtract the final modules by filtering with E- Value <1e-15 and coverage cut off >0.35.

sh hmmscan-parser.sh gh31_hmmscan.out.dm > gh31_hmmscan.out.dm.ps 

cat gh31_hmmscan.out.dm.ps  | awk '$5<1e-15&&$10>0.35' > gh31_hmmscan.out.dm.ps .stringent












